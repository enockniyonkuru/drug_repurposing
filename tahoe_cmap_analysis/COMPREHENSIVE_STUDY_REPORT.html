<!DOCTYPE html>
<html>
<head>
<title>COMPREHENSIVE_STUDY_REPORT.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="drug-repurposing-pipeline-comprehensive-study-report">Drug Repurposing Pipeline: Comprehensive Study Report</h1>
<p><strong>Date</strong>: October 27, 2025</p>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#executive-summary">Executive Summary</a></li>
<li><a href="#study-overview">Study Overview</a></li>
<li><a href="#part-1-data-preparation">Part 1: Data Preparation</a></li>
<li><a href="#part-2-pipeline-execution">Part 2: Pipeline Execution</a></li>
<li><a href="#part-3-results-analysis">Part 3: Results Analysis</a></li>
<li><a href="#part-4-detailed-insights">Part 4: Detailed Insights</a></li>
<li><a href="#part-5-method-comparison">Part 5: Method Comparison</a></li>
</ol>
<hr>
<h2 id="executive-summary">Executive Summary</h2>
<p>This comprehensive drug repurposing study systematically compared two computational methods—<strong>CMAP</strong> (Connectivity Map) and <strong>TAHOE</strong>—across 58 disease signatures to identify potential therapeutic candidates. The analysis leveraged gene expression signatures from CREEDS and Sirota Lab, benchmarked against Open Targets evidence.</p>
<h3 id="key-achievements">Key Achievements:</h3>
<ul>
<li><strong>6,161 total drug-disease associations</strong> identified across 43 diseases</li>
<li><strong>33 high-confidence drugs</strong> validated by both methods (100% evidence support)</li>
<li><strong>~60% novel predictions</strong> representing unexplored therapeutic opportunities</li>
<li><strong>Complementary method strengths</strong> demonstrated through comparative analysis</li>
</ul>
<hr>
<h2 id="study-overview">Study Overview</h2>
<h3 id="objectives">Objectives</h3>
<ol>
<li>Systematically evaluate CMAP and TAHOE drug signature databases</li>
<li>Identify high-confidence drug repurposing candidates</li>
<li>Benchmark predictions against existing clinical evidence</li>
<li>Compare method performance and complementarity</li>
<li>Discover novel drug-disease associations</li>
</ol>
<h3 id="approach">Approach</h3>
<ul>
<li><strong>Disease Signatures</strong>: 58 curated from CREEDS (56) + Sirota Lab (2)</li>
<li><strong>Drug Signatures</strong>: CMAP (1,309 drugs) and TAHOE (379 drugs)</li>
<li><strong>Shared Drug Analysis</strong>: 61 drugs common to both databases</li>
<li><strong>Evidence Validation</strong>: Open Targets Platform + Drug Repurposing Hub (not yet integrated)</li>
<li><strong>Total Pipeline Runs</strong>: 116 (58 diseases × 2 methods)</li>
</ul>
<hr>
<h2 id="part-1-data-preparation">Part 1: Data Preparation</h2>
<h3 id="11-disease-signatures">1.1 Disease Signatures</h3>
<h4 id="source-creeds-database-crowd-extracted-expression-of-differential-signatures">Source: CREEDS Database (Crowd Extracted Expression of Differential Signatures)</h4>
<ul>
<li><strong>Reference</strong>: <a href="https://www.nature.com/articles/ncomms12846">Wang et al., Nature Communications 2016</a> at Mt Sinai</li>
<li><strong>Content</strong>:
<ul>
<li>1,081 disease signatures covering 450 diseases from 748 studies</li>
<li>1,238 drug perturbation submissions (343 drugs from 443 studies)</li>
<li>Diseased vs normal tissues/cells from mammalian species (human, mouse, rat)</li>
<li>Data extracted from GEO (Gene Expression Omnibus), manually curated for quality control.</li>
</ul>
</li>
</ul>
<h4 id="gene-selection-methodology-characteristic-direction-cd-algorithm">Gene Selection Methodology: Characteristic Direction (CD) Algorithm</h4>
<p>The CD algorithm was chosen over traditional methods (logFC, t-test) due to superior performance:</p>
<ul>
<li><strong>Computation</strong>: Direction vector in high-dimensional gene-expression space</li>
<li><strong>Output</strong>: Weight per gene (positive = upregulated; negative = downregulated)</li>
<li><strong>Magnitude</strong>: Analogous to logFC but more stable</li>
<li><strong>Export Format</strong>: log2 fold-change–like values (ranked continuous scores)</li>
<li><strong>Typical Output</strong>: Top/bottom 250 genes (250 up / 250 down)</li>
</ul>
<h4 id="curation-process-started-with-subset-only-manually-curated">Curation Process [Started with subset only manually curated]</h4>
<ol>
<li><strong>Initial Dataset</strong>: 330 disease names</li>
<li><strong>DOID Mapping</strong>: 235 unique Disease Ontology IDs</li>
<li><strong>Sample Selection</strong>: 95 diseases evaluated</li>
<li><strong>Filtering Criteria</strong>: Human origin + matchable DOID/disease name</li>
<li><strong>Final Dataset</strong>: 58 disease signatures
<ul>
<li>56 from CREEDS</li>
<li>2 from Sirota Lab (CoreFibroidSignature, EndothelialSignature)</li>
</ul>
</li>
</ol>
<h4 id="gene-signature-structure">Gene Signature Structure</h4>
<p>Each signature contains:</p>
<ul>
<li><code>gene_symbol</code>: Gene identifier</li>
<li><code>logfc_experimentIDs</code>: Experiment-specific log fold changes</li>
<li><code>mean_logfc</code>: Average across experiments</li>
<li><code>median_logfc</code>: Median across experiments</li>
<li><code>common_experiment</code>: Logfc of the experiment that has more genes</li>
</ul>
<h3 id="12-drug-signatures">1.2 Drug Signatures</h3>
<h4 id="shared-drug-analysis">Shared Drug Analysis</h4>
<ul>
<li><strong>61 unique drugs</strong> present in both CMAP and TAHOE</li>
<li><strong>12,544 shared genes</strong> used as common input space</li>
</ul>
<h4 id="cmap-signature-database">CMAP Signature Database</h4>
<ul>
<li><strong>Total Drugs</strong>: 1,309 unique compounds</li>
<li><strong>Experiments</strong>: 6,100 total</li>
<li><strong>Analysis Subset</strong>: 434 experiments × 12,527 genes
<ul>
<li>17 genes missing (not present in CMAP data)</li>
</ul>
</li>
<li><strong>Coverage</strong>: Broad but variable depth per drug</li>
</ul>
<h4 id="tahoe-signature-database">TAHOE Signature Database</h4>
<ul>
<li><strong>Total Drugs</strong>: 379 unique compounds</li>
<li><strong>Experiments</strong>: 56,827 total (much deeper per-drug coverage)</li>
<li><strong>Analysis Subset</strong>: 13,500 experiments × 12,544 genes</li>
<li><strong>Processing</strong>: Ranked by descending Logfc (most upregulated first)</li>
<li><strong>Format</strong>: CMap-compatible using Entrez IDs</li>
</ul>
<h3 id="13-drug-evidence-sources">1.3 Drug Evidence Sources</h3>
<h4 id="primary-sources">Primary Sources</h4>
<ol>
<li>
<p><strong>Drug Repurposing Hub</strong> (Broad Institute) - haven't used it yet</p>
<ul>
<li>URL: clue.io/repurposing</li>
<li>Comprehensive drug annotation database</li>
</ul>
</li>
<li>
<p><strong>Open Targets Platform</strong> (currently using this only)</p>
<ul>
<li>URL: platform.opentargets.org</li>
<li>Evidence-based drug-disease associations</li>
<li>Clinical trial data and approval status</li>
</ul>
</li>
</ol>
<h4 id="evidence-data-structure">Evidence Data Structure</h4>
<p><strong>Key Columns</strong>:</p>
<ul>
<li><code>drugId</code>: Unique drug identifier</li>
<li><code>targetId</code>: Molecular target</li>
<li><code>diseaseId</code>: Disease ontology ID</li>
<li><code>phase</code>: Clinical trial phase (0-4)</li>
<li><code>status</code>: Approval/trial status</li>
<li><code>urls</code>: Supporting evidence links</li>
<li><code>label</code>: Drug name</li>
<li><code>approvedSymbol</code>: Target gene symbol</li>
<li><code>targetClass</code>: Target classification</li>
<li><code>mechanismOfAction</code>: MOA description</li>
<li><code>prefName</code>: Preferred drug name</li>
<li><code>synonyms</code>: Alternative names</li>
<li><code>drugType</code>: Small molecule/biologic/etc.</li>
<li><code>targetName</code>: Target protein name</li>
</ul>
<hr>
<h2 id="part-2-pipeline-execution">Part 2: Pipeline Execution</h2>
<h3 id="21-pipeline-configuration">2.1 Pipeline Configuration</h3>
<p><strong>Analysis Parameters</strong>:</p>
<ul>
<li><strong>Disease Signatures Tested</strong>: 58</li>
<li><strong>Drug Signature Sources</strong>: CMAP and TAHOE</li>
<li><strong>Total Runs</strong>: 116 (58 × 2 methods)</li>
<li><strong>logFC Threshold</strong>: 0.00 (no filtering applied)</li>
<li><strong>logFC Column Used</strong>: <code>common_experiment</code></li>
<li><strong>P-value Filter</strong>: None (disabled for comprehensive analysis)</li>
</ul>
<h3 id="22-computational-approach">2.2 Computational Approach</h3>
<p><strong>Method</strong>: GSEA-Inspired Kolmogorov-Smirnov (KS)-Like Connectivity Scoring</p>
<p>The pipeline uses a custom implementation inspired by Gene Set Enrichment Analysis (GSEA) methodology, but <strong>not the standard GSEA algorithm</strong>. The approach is specifically tailored for drug repurposing by computing bidirectional connectivity scores.</p>
<h4 id="core-algorithm-cmapscore-function">Core Algorithm: <code>cmap_score()</code> Function</h4>
<p><strong>Mathematical Approach</strong>:</p>
<ul>
<li>Computes a <strong>Kolmogorov-Smirnov (KS)-like statistic</strong> for gene set enrichment</li>
<li>Evaluates disease signature genes (up-regulated and down-regulated sets separately)</li>
<li>Compares against ranked drug perturbation profiles</li>
<li>Generates a signed connectivity score indicating reversal or mimicry</li>
</ul>
<p><strong>Scoring Process</strong>:</p>
<ol>
<li>
<p><strong>Input Preparation</strong>:</p>
<ul>
<li>Disease signature: Up-regulated genes (GeneID list)</li>
<li>Disease signature: Down-regulated genes (GeneID list)</li>
<li>Drug signature: Ranked gene expression profile (Entrez IDs with ranks)</li>
</ul>
</li>
<li>
<p><strong>KS-Like Statistic Calculation</strong>:</p>
<ul>
<li>Compute <code>ks_up</code>: Enrichment statistic for up-regulated disease genes</li>
<li>Compute <code>ks_down</code>: Enrichment statistic for down-regulated disease genes</li>
<li>Each statistic measures whether disease genes are enriched at the top or bottom of the drug's ranked gene list</li>
</ul>
</li>
<li>
<p><strong>Connectivity Score Combination</strong>:</p>
<pre class="hljs"><code><div>connectivity_score = ks_up - ks_down
</div></code></pre>
<ul>
<li><strong>Negative scores</strong>: Drug reverses disease signature (therapeutic potential)</li>
<li><strong>Positive scores</strong>: Drug mimics disease signature (contraindicated)</li>
<li><strong>Zero/neutral</strong>: No significant relationship</li>
</ul>
</li>
<li>
<p><strong>Statistical Validation</strong>:</p>
<ul>
<li><strong>Null Distribution</strong>: Generated via <code>random_score()</code> function</li>
<li><strong>Method</strong>: Permutation testing (default: 100,000 iterations)</li>
<li><strong>Process</strong>: Random gene sets sampled to create empirical null distribution</li>
<li><strong>P-values</strong>: Computed as frequency of null scores ≥ observed score</li>
<li><strong>Q-values</strong>: FDR correction applied using Storey's q-value method</li>
</ul>
</li>
</ol>
<h4 id="implementation-details">Implementation Details</h4>
<p><strong>Functions Used</strong>:</p>
<ul>
<li><code>clean_table()</code>: Preprocesses disease signatures, maps to Entrez IDs, filters by logFC/p-value</li>
<li><code>cmap_score()</code>: Computes KS-like connectivity score for one drug-disease pair</li>
<li><code>query_score()</code>: Applies cmap_score across all drug experiments for a disease</li>
<li><code>random_score()</code>: Generates null distribution via permutation testing</li>
<li><code>query()</code>: Assembles results with p-values and q-values</li>
</ul>
<p><strong>Gene Universe</strong>:</p>
<ul>
<li>Analysis restricted to genes present in both disease signature and drug database</li>
<li>CMAP: 12,527 genes (17 missing from shared set)</li>
<li>TAHOE: 12,544 genes (complete shared set)</li>
</ul>
<p><strong>Output Structure</strong>:</p>
<ul>
<li>Per-disease results directories</li>
<li>Ranked drug lists with connectivity scores</li>
<li>Statistical significance metrics (p-values, q-values)</li>
<li>Visualization plots (heatmaps, histograms, upset plots)</li>
</ul>
<p><strong>Note:</strong> This is the traditioanl way the Drug Repurposing package usually runs, didn't change anything</p>
<hr>
<h2 id="part-3-results-analysis">Part 3: Results Analysis</h2>
<h3 id="31-understanding-the-two-analysis-approaches">3.1 Understanding the Two Analysis Approaches</h3>
<p>This study employed <strong>two complementary analytical strategies</strong>:</p>
<h4 id="strategy-1-full-dataset-analysis">Strategy 1: Full Dataset Analysis</h4>
<ul>
<li><strong>Scope</strong>: All drug hits from CMAP and TAHOE independently</li>
<li><strong>Purpose</strong>: Maximize discovery potential using each method's complete drug library</li>
<li><strong>Advantage</strong>: Captures method-specific strengths and unique drug candidates</li>
</ul>
<h4 id="strategy-2-shared-drug-subset-analysis">Strategy 2: Shared Drug Subset Analysis</h4>
<ul>
<li><strong>Scope</strong>: Only the 61 drugs present in BOTH databases</li>
<li><strong>Purpose</strong>: Direct method-to-method comparison on identical compounds</li>
<li><strong>Advantage</strong>: Eliminates confounding factors from different drug libraries</li>
<li><strong>Use Case</strong>: Validates method reliability and identifies consensus predictions</li>
</ul>
<h3 id="32-full-dataset-results-all-drugs">3.2 Full Dataset Results (All Drugs)</h3>
<h4 id="overall-statistics">Overall Statistics</h4>
<ul>
<li><strong>Diseases Analyzed</strong>: 58 (later filtered to 43 with sufficient hits)</li>
<li><strong>Total CMAP Hits</strong>: 3,524 drug-disease associations</li>
<li><strong>Total TAHOE Hits</strong>: 2,637 drug-disease associations</li>
<li><strong>Total Unique Associations</strong>: 6,161</li>
<li><strong>Common Drugs</strong> (found by both methods): 33 high-confidence candidates</li>
</ul>
<h4 id="evidence-validation-rates">Evidence Validation Rates</h4>
<table>
<thead>
<tr>
<th>Method</th>
<th>Total Hits</th>
<th>With Evidence</th>
<th>Evidence Rate</th>
<th>Novel Hits</th>
<th>Novel Rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>CMAP</td>
<td>3,524</td>
<td>1,363</td>
<td>38.7%</td>
<td>2,161</td>
<td>61.3%</td>
</tr>
<tr>
<td>TAHOE</td>
<td>2,637</td>
<td>1,131</td>
<td>42.9%</td>
<td>1,506</td>
<td>57.1%</td>
</tr>
<tr>
<td><strong>Combined</strong></td>
<td><strong>6,161</strong></td>
<td><strong>2,494</strong></td>
<td><strong>40.5%</strong></td>
<td><strong>3,667</strong></td>
<td><strong>59.5%</strong></td>
</tr>
</tbody>
</table>
<h4 id="key-observations">Key Observations</h4>
<ol>
<li><strong>TAHOE shows higher specificity</strong>: 42.9% evidence rate vs CMAP's 38.7%</li>
<li><strong>CMAP shows higher sensitivity</strong>: 3,524 total hits vs TAHOE's 2,637</li>
<li><strong>Substantial novel discovery</strong>: ~60% of predictions lack prior evidence</li>
<li><strong>Complementary coverage</strong>: Different drugs identified by each method</li>
</ol>
<h4 id="helpful-resources-for-full-dataset-analysis">Helpful Resources for Full Dataset Analysis</h4>
<ul>
<li>Summary of counts per disease: <a href="https://drive.google.com/file/d/1wXMe07uWuG1CAa4m4f7LuQoM0KVAxB1a/view?usp=sharing"><code>full_summary_with_total_row.csv</code></a></li>
<li>Actual list of drugs per disease: <a href="https://drive.google.com/file/d/1C7vkZfOnbZ2ZCEZ6nVXmaWNDeOYmyhgS/view?usp=sharing"><code>full_summary_drug_sets_by_disease.csv</code></a></li>
<li>Json file of disease-drug-evidence (dictonary like): <a href="https://drive.google.com/file/d/19eDDJ1rKXZDU6LXAPJqRGFMA2U2MKrVm/view?usp=sharing"><code>drug_disease_combined.json</code></a></li>
</ul>
<h3 id="33-shared-drug-subset-results-61-common-drugs">3.3 Shared Drug Subset Results (61 Common Drugs)</h3>
<h4 id="shared-drug-predictions-analysis">Shared Drug Predictions Analysis</h4>
<p>When analyzing drug predictions per disease per method using the <strong>61 drugs common to both CMAP and TAHOE databases</strong>:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>CMAP</th>
<th>TAHOE</th>
<th>Shared</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Total Hits from Shared Drugs</strong></td>
<td>299</td>
<td>290</td>
<td>33</td>
</tr>
<tr>
<td><strong>Diseases Covered</strong></td>
<td>43</td>
<td>43</td>
<td>21</td>
</tr>
<tr>
<td><strong>Hits with Evidence</strong></td>
<td>249 (83.3%)</td>
<td>145 (50.0%)</td>
<td>33 (100%)</td>
</tr>
<tr>
<td><strong>Novel Hits</strong></td>
<td>50 (16.7%)</td>
<td>145 (50.0%)</td>
<td>0 (0%)</td>
</tr>
</tbody>
</table>
<p><strong>Important Note</strong>: This analysis focused on the <strong>subset of 61 drugs present in both databases</strong>, not the full drug libraries. The &quot;Shared&quot; column represents drugs that appeared in <strong>both methods' predictions</strong> for the same disease, demonstrating consensus between CMAP and TAHOE on these specific compounds from the shared drug experiments.</p>
<h4 id="critical-finding-100-validation-rate-for-shared-drugs">Critical Finding: 100% Validation Rate for Shared Drugs</h4>
<p><strong>All 33 drugs that appeared in BOTH methods' predictions (from the 61-drug subset) have existing evidence support.</strong></p>
<p><strong>Implications</strong>:</p>
<ul>
<li><strong>Extremely high confidence</strong>: Consensus predictions are highly reliable</li>
<li><strong>Reduced false positives</strong>: Independent validation filters spurious associations</li>
<li><strong>Method validation</strong>: Confirms both algorithms capture genuine signals when analyzing the same drug set</li>
</ul>
<h4 id="evidence-enrichment-in-shared-drug-analysis">Evidence Enrichment in Shared Drug Analysis</h4>
<p>Comparing full dataset vs shared drug subset:</p>
<ul>
<li><strong>CMAP</strong>: 38.7% → 83.3% evidence rate (2.2× enrichment)</li>
<li><strong>TAHOE</strong>: 42.9% → 50.0% evidence rate (1.2× enrichment)</li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>Predictions from the shared drug subset are strongly enriched for known associations</li>
<li>Validates the ranking algorithms of both methods</li>
<li>Lower-ranked hits may still contain valuable novel candidates</li>
</ul>
<h4 id="helpful-resources-for-shared-dataset-analysis">Helpful Resources for Shared Dataset Analysis</h4>
<ul>
<li>Summary of counts per disease: <a href="https://drive.google.com/file/d/18YRJx8q4j2Kq3IMtzbpV2ZH1E0TughBe/view?usp=sharing"><code>shared_summary_with_total_row.csv</code></a></li>
<li>Actual list of drugs per disease: <a href="https://drive.google.com/file/d/1Qq4CFGKyv8YkhG1ChFxC5FSrat6xD9RR/view?usp=sharing"><code>shared_summary_drug_sets_by_disease.csv</code> </a></li>
<li>Json file of disease-drug-evidence (dictonary like):  <a href="https://drive.google.com/file/d/14dVzxRA40pdR-0BoqZGmhkYyASn2ru1_/view?usp=sharing"><code>drug_disease_combined_shared.json</code></a></li>
</ul>
<hr>
<h2 id="part-4-detailed-insights">Part 4: Detailed Insights</h2>
<h3 id="41-method-complementarity">4.1 Method Complementarity</h3>
<p><strong>Key Finding</strong>: CMAP and TAHOE show limited overlap (only 33 common drugs identified by both methods across all diseases from the shared drug experiments), suggesting they capture different aspects of drug-disease relationships.</p>
<h4 id="cmap-characteristics">CMAP Characteristics</h4>
<ul>
<li><strong>Drug Library</strong>: 1,309 compounds (larger)</li>
<li><strong>Experiments</strong>: 6,100 (moderate depth)</li>
<li><strong>Coverage</strong>: 25/43 diseases (58.1%)</li>
<li><strong>Total Hits</strong>: 3,524 (higher sensitivity)</li>
<li><strong>Evidence Rate</strong>: 38.7% (lower specificity)</li>
<li><strong>Strength</strong>: Broad discovery, good for hypothesis generation</li>
<li><strong>Limitation</strong>: More false positives, requires validation</li>
</ul>
<h4 id="tahoe-characteristics">TAHOE Characteristics</h4>
<ul>
<li><strong>Drug Library</strong>: 379 compounds (smaller but curated)</li>
<li><strong>Experiments</strong>: 56,827 (much deeper per drug)</li>
<li><strong>Coverage</strong>: 24/43 diseases (55.8%)</li>
<li><strong>Total Hits</strong>: 2,637 (higher specificity)</li>
<li><strong>Evidence Rate</strong>: 42.9% (better precision)</li>
<li><strong>Strength</strong>: Evidence-enriched, reliable predictions</li>
<li><strong>Limitation</strong>: May miss some valid candidates</li>
</ul>
<h4 id="synergistic-use">Synergistic Use</h4>
<p><strong>Recommendation</strong>: Use both methods together</p>
<ul>
<li>CMAP for broad discovery and sensitivity</li>
<li>TAHOE for validation and specificity</li>
<li>Shared predictions for highest confidence</li>
<li>Method-specific hits for unique opportunities</li>
</ul>
<h3 id="42-disease-coverage-patterns">4.2 Disease Coverage Patterns</h3>
<h4 id="cmap-only-diseases-22-diseases">CMAP-Only Diseases (22 diseases)</h4>
<p>Diseases where only CMAP produced results:</p>
<ul>
<li>Alzheimer's disease</li>
<li>Asthma</li>
<li>Atherosclerosis</li>
<li>CoreFibroidSignature (Sirota Lab)</li>
<li>Crohn's disease</li>
<li>Dermatomyositis</li>
<li>Duchenne muscular dystrophy</li>
<li>Epithelial proliferation</li>
<li>Hypercholesterolemia</li>
<li>Hypoxia</li>
<li>Lupus</li>
<li>Pancreatic cancer</li>
<li>Type 2 diabetes</li>
<li>Ulcerative colitis</li>
<li><em>[8 additional diseases]</em></li>
</ul>
<p><strong>Possible Reasons</strong>:</p>
<ul>
<li>Disease signatures better match CMAP's drug library</li>
<li>TAHOE's stricter filtering criteria</li>
<li>Different gene coverage or normalization</li>
</ul>
<h4 id="tahoe-only-diseases-18-diseases">TAHOE-Only Diseases (18 diseases)</h4>
<p>Diseases where only TAHOE produced results:</p>
<ul>
<li>Astrocytoma</li>
<li>Autism spectrum disorder</li>
<li>Breast cancer</li>
<li>Hepatitis C</li>
<li>HIV/AIDS</li>
<li>Melanoma</li>
<li>Meningococcal infection</li>
<li>Prostate cancer</li>
<li>Pulmonary fibrosis</li>
<li>Schizophrenia</li>
<li>Tuberculosis</li>
<li><em>[7 additional diseases]</em></li>
</ul>
<p><strong>Possible Reasons</strong>:</p>
<ul>
<li>Disease signatures better match TAHOE's drug library</li>
<li>TAHOE's deeper per-drug profiling captures subtle signals</li>
<li>Different experimental conditions or cell types</li>
</ul>
<h4 id="both-methods-21-diseases">Both Methods (21 diseases)</h4>
<p>Diseases with results from both CMAP and TAHOE:</p>
<ul>
<li>Bipolar disorder</li>
<li>Chronic granulomatous disease</li>
<li>COPD (Chronic obstructive pulmonary disease)</li>
<li>Colorectal cancer</li>
<li>Eczema</li>
<li>Endometrial cancer</li>
<li>Glioblastoma</li>
<li>Leukemia</li>
<li>Lymphoma</li>
<li>Obesity</li>
<li>Oligodendroglioma</li>
<li>Ovarian cancer</li>
<li>Parkinson's disease</li>
<li>Psoriasis</li>
<li>Rheumatoid arthritis</li>
<li>Stroke</li>
<li>Type 1 diabetes</li>
<li><em>[4 additional diseases]</em></li>
</ul>
<p><strong>Significance</strong>:</p>
<ul>
<li>These diseases have the most robust predictions</li>
<li>Highest confidence for drug repurposing</li>
<li>Enable direct method comparison</li>
<li>Best candidates for clinical investigation</li>
</ul>
<h3 id="43-top-performing-diseases">4.3 Top Performing Diseases</h3>
<h4 id="by-total-hits-full-dataset">By Total Hits (Full Dataset)</h4>
<ol>
<li><strong>Endometrial cancer</strong>: 216 hits (125 CMAP + 91 TAHOE)</li>
<li><strong>Glioblastoma</strong>: 214 hits (123 CMAP + 91 TAHOE)</li>
<li><strong>Hypercholesterolemia</strong>: 121 hits (CMAP only)</li>
<li><strong>Dermatomyositis</strong>: 119 hits (CMAP only)</li>
<li><strong>Ulcerative colitis</strong>: 118 hits (CMAP only)</li>
<li><strong>Chronic granulomatous disease</strong>: 208 hits (117 CMAP + 91 TAHOE)</li>
<li><strong>Colorectal cancer</strong>: 207 hits (116 CMAP + 91 TAHOE)</li>
<li><strong>Eczema</strong>: 208 hits (117 CMAP + 91 TAHOE)</li>
<li><strong>Oligodendroglioma</strong>: 207 hits (116 CMAP + 91 TAHOE)</li>
<li><strong>Ovarian cancer</strong>: 208 hits (117 CMAP + 91 TAHOE)</li>
</ol>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>Diseases with high hit counts likely have:
<ul>
<li>More distinctive gene expression signatures</li>
<li>Better characterized molecular pathways</li>
<li>Greater therapeutic opportunities</li>
</ul>
</li>
<li>TAHOE shows consistent output (~91 hits per disease)</li>
<li>CMAP shows more variable output (8-125 hits)</li>
</ul>
<h4 id="by-shared-drugs-consensus-analysis">By Shared Drugs (Consensus Analysis)</h4>
<p><strong>Diseases with 2 shared drugs</strong> (highest confidence):</p>
<ul>
<li>Bipolar disorder</li>
<li>Chronic granulomatous disease</li>
<li>COPD</li>
<li>Colorectal cancer</li>
<li>Eczema</li>
<li>Endometrial cancer</li>
<li>Glioblastoma</li>
<li>Leukemia</li>
<li>Lymphoma</li>
<li>Obesity</li>
<li>Oligodendroglioma</li>
<li>Ovarian cancer</li>
<li>Psoriasis</li>
<li>Rheumatoid arthritis</li>
<li>Stroke</li>
<li>Type 1 diabetes</li>
</ul>
<p><strong>Disease with 1 shared drug</strong>:</p>
<ul>
<li>Parkinson's disease</li>
</ul>
<hr>
<h2 id="part-5-method-comparison">Part 5: Method Comparison</h2>
<h3 id="51-quantitative-comparison">5.1 Quantitative Comparison</h3>
<h4 id="full-dataset-analysis-all-drugs">Full Dataset Analysis (All Drugs)</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>CMAP</th>
<th>TAHOE</th>
<th>Winner</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Drug Library Size</strong></td>
<td>1,309</td>
<td>379</td>
<td>CMAP</td>
</tr>
<tr>
<td><strong>Experiment Depth</strong></td>
<td>6,100</td>
<td>56,827</td>
<td>TAHOE</td>
</tr>
<tr>
<td><strong>Total Hits</strong></td>
<td>3,524</td>
<td>2,637</td>
<td>CMAP</td>
</tr>
<tr>
<td><strong>Evidence Rate</strong></td>
<td>38.7%</td>
<td>42.9%</td>
<td>TAHOE</td>
</tr>
<tr>
<td><strong>Novel Rate</strong></td>
<td>61.3%</td>
<td>57.1%</td>
<td>CMAP</td>
</tr>
<tr>
<td><strong>Disease Coverage</strong></td>
<td>25</td>
<td>24</td>
<td>CMAP</td>
</tr>
<tr>
<td><strong>Consistency</strong></td>
<td>Variable</td>
<td>Uniform</td>
<td>TAHOE</td>
</tr>
</tbody>
</table>
<h4 id="shared-drug-subset-analysis-61-common-drugs">Shared Drug Subset Analysis (61 Common Drugs)</h4>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>CMAP</th>
<th>TAHOE</th>
<th>Shared (Consensus)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Total Hits from Shared Drugs</strong></td>
<td>299</td>
<td>290</td>
<td>33</td>
</tr>
<tr>
<td><strong>Diseases Covered</strong></td>
<td>43</td>
<td>43</td>
<td>21</td>
</tr>
<tr>
<td><strong>Evidence Rate</strong></td>
<td>83.3%</td>
<td>50.0%</td>
<td>100%</td>
</tr>
<tr>
<td><strong>Novel Rate</strong></td>
<td>16.7%</td>
<td>50.0%</td>
<td>0%</td>
</tr>
<tr>
<td><strong>Average Hits per Disease</strong></td>
<td>7.0</td>
<td>6.7</td>
<td>1.6</td>
</tr>
<tr>
<td><strong>Winner</strong></td>
<td>CMAP (higher evidence rate)</td>
<td>TAHOE (consistent)</td>
<td>Both (perfect validation)</td>
</tr>
</tbody>
</table>
<p><strong>Key Insights from Shared Drug Analysis</strong>:</p>
<ul>
<li><strong>CMAP shows dramatic evidence enrichment</strong>: 38.7% → 83.3% (2.2× improvement)</li>
<li><strong>TAHOE maintains moderate enrichment</strong>: 42.9% → 50.0% (1.2× improvement)</li>
<li><strong>Consensus predictions are 100% validated</strong>: All 33 shared drugs have evidence</li>
<li><strong>CMAP's ranking algorithm is highly effective</strong>: Top predictions strongly enriched for known associations</li>
</ul>
<h3 id="52-qualitative-comparison">5.2 Qualitative Comparison</h3>
<h4 id="cmap-advantages">CMAP Advantages</h4>
<ol>
<li><strong>Broader drug coverage</strong>: 3.5× more compounds</li>
<li><strong>Higher sensitivity</strong>: More total discoveries</li>
<li><strong>Better ranking</strong>: Top predictions highly enriched for evidence</li>
<li><strong>Flexibility</strong>: Works across more disease types</li>
</ol>
<h4 id="tahoe-advantages">TAHOE Advantages</h4>
<ol>
<li><strong>Deeper profiling</strong>: 9.3× more experiments</li>
<li><strong>Higher baseline specificity</strong>: Better evidence rate</li>
<li><strong>More consistent</strong>: Uniform output across diseases</li>
<li><strong>Quality over quantity</strong>: More reliable predictions</li>
</ol>
<h4 id="when-to-use-each-method">When to Use Each Method</h4>
<p><strong>Use CMAP when</strong>:</p>
<ul>
<li>Exploring new disease areas</li>
<li>Generating hypotheses</li>
<li>Seeking broad coverage</li>
<li>Prioritizing sensitivity over specificity</li>
</ul>
<p><strong>Use TAHOE when</strong>:</p>
<ul>
<li>Validating specific hypotheses</li>
<li>Seeking high-confidence predictions</li>
<li>Prioritizing specificity over sensitivity</li>
<li>Working with well-characterized diseases</li>
</ul>
<p><strong>Use Both when</strong>:</p>
<ul>
<li>Maximum confidence needed</li>
<li>Comprehensive coverage desired</li>
<li>Resources available for validation</li>
<li>Clinical investigation planned</li>
</ul>

</body>
</html>
