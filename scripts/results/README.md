# Results Directory

This directory contains the output files generated by the drug repurposing pipeline.

## Directory Structure

Results are organized by timestamp to preserve different analysis runs:

```
results/
├── 20250101-120000/              # Single profile run
│   ├── CoreFibroidSignature_results.RData
│   ├── CoreFibroidSignature_hits_q0.05.csv
│   ├── sessionInfo.txt
│   └── img/
│       ├── cmap_score.jpg
│       └── heatmap_cmap_hits.jpg
├── profile_comparison_20250101-130000/  # Profile comparison run
│   ├── lenient_hits.csv
│   ├── default_hits.csv
│   ├── strict_hits.csv
│   ├── combined_profile_hits.csv
│   ├── profile_summary_stats.csv
│   └── img/
│       ├── profile_comparison_score_dist.jpg
│       ├── profile_overlap_heatmap.jpg
│       └── profile_upset.jpg
└── sweep_20250101-140000/        # Sweep mode run
    ├── cutoff_0.5/
    ├── cutoff_1.0/
    ├── cutoff_1.5/
    ├── aggregate/
    │   ├── robust_hits.csv
    │   └── cutoff_summary.csv
    └── CoreFibroidSignature_results.RData
```

## Output Files

### Single Profile Analysis

**Main Results:**
- `<dataset>_results.RData` - Complete R data object with all results
- `<dataset>_hits_q<threshold>.csv` - Significant drug hits (filtered by q-value)
- `sessionInfo.txt` - R session information for reproducibility

**Visualizations (in `img/` subdirectory):**
- `cmap_score.jpg` - Distribution of connectivity scores
- `heatmap_cmap_hits.jpg` - Heatmap of top drug hits

### Profile Comparison Analysis

**Results Files:**
- `<profile>_hits.csv` - Results for each individual profile
- `combined_profile_hits.csv` - All results combined with profile identifiers
- `profile_summary_stats.csv` - Summary statistics per profile

**Visualizations:**
- `profile_comparison_score_dist.jpg` - Score distributions across profiles
- `profile_overlap_heatmap.jpg` - Drug overlap between profiles
- `profile_overlap_atleast2.jpg` - Drugs found in multiple profiles
- `profile_upset.jpg` - UpSet plot showing profile intersections

### Sweep Mode Analysis

**Directory Structure:**
- `cutoff_X.X/` - Individual results for each fold-change cutoff
- `aggregate/` - Final robust results after filtering

**Key Files:**
- `robust_hits.csv` - Drugs passing robust filtering criteria
- `cutoff_summary.csv` - Summary statistics for each cutoff tested

## File Formats

### CSV Files

All CSV output files contain drug repurposing results with columns such as:
- `name` - Drug name
- `cmap_score` - Connectivity score (negative = reversal)
- `pval` - Empirical p-value
- `qval` - FDR-adjusted q-value
- Additional metadata from CMap database

### RData Files

Binary R data files containing complete analysis objects. Load with:
```r
load("results/<timestamp>/<dataset>_results.RData")
```

## Results Not Included in Repository

**All result files are excluded from the GitHub repository** because:
1. They are generated outputs (reproducible from source data)
2. They can be large depending on analysis parameters
3. They vary between runs and users

To generate results:
```r
# In RStudio
setwd("scripts")
source("runall.R")
```

## Interpreting Results

### Connectivity Scores
- **Negative scores**: Drug reverses disease signature (desired)
- **Positive scores**: Drug mimics disease signature (undesired)
- **Magnitude**: Larger absolute values indicate stronger effects

### Statistical Significance
- **p-value**: Empirical probability from permutation testing
- **q-value**: FDR-corrected p-value (controls false discovery rate)
- **Threshold**: Default q < 0.05 for significance

### Top Candidates
Focus on drugs with:
- Strong negative connectivity scores
- Low q-values (< 0.05)
- Consistent appearance across multiple analyses (if using comparison/sweep modes)

## Archiving Results

To preserve important results:

1. **Rename the timestamp directory** to something meaningful:
   ```bash
   mv results/20250101-120000 results/fibroid_analysis_v1
   ```

2. **Export key results** to a separate location:
   ```bash
   cp results/fibroid_analysis_v1/*_hits.csv ~/my_publications/
   ```

3. **Document your analysis** in a lab notebook or README

## Cleaning Up Old Results

To remove old result directories:

```bash
# Remove specific run
rm -rf results/20250101-120000

# Remove all results (careful!)
rm -rf results/*/
```

## Questions?

For help interpreting results or troubleshooting:
- See the main [README.md](../../README.md)
- Contact: enock.niyonkuru@ucsf.edu
